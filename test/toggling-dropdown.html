<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <title>vaadin-combo basic tests</title>
  <script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../bower_components/web-component-tester/browser.js"></script>
  <script src="../bower_components/test-fixture/test-fixture-mocha.js"></script>

  <link rel="import" href="common.html">
  <script src="common.js"></script>
</head>

<body>

<test-fixture id="combobox">
  <template>
    <vaadin-combo-box></vaadin-combo-box>
  </template>
</test-fixture>


<script>
  describe('toggling the dropdown', function() {
    var combobox;

    beforeEach(function() {
      combobox = fixture('combobox');
    });

    describe('opening', function() {
      it('should open on click', function() {
        combobox.$$('paper-input-container').fire('tap')

        expect(combobox.opened).to.be.true;
      });

      it('should open on function call', function() {
        combobox.open();

        expect(combobox.opened).to.be.true;
      });

      it('should not close an open popup', function() {
        combobox.open();

        combobox.open();

        expect(combobox.opened).to.be.true;
      });

      describeSkipIf(!fullScreen, 'fullscreen', function() {

        it('should focus input on fullscreen dropdown open', function(done) {
          combobox.$.overlay.fullScreen = true;
          combobox.open();
          Polymer.Base.async(function() {
            var focusedInput = Polymer.dom(combobox.$.overlay).querySelector('input:focus');
            expect(focusedInput).to.equal(combobox.$.fullScreenInput);
            done();
          });
        });

      });

    });
  });
</script>

</body>

</html>
